{"ast":null,"code":"import { DomEventsBuilder } from '../services';\nimport { DateCategoryAxis, Point } from '../core';\nimport { MOUSEWHEEL_DELAY, MOUSEWHEEL, SELECT_START, SELECT, SELECT_END } from './constants';\nimport { LEFT, RIGHT, MIN_VALUE, MAX_VALUE } from '../common/constants';\nimport { addClass, Class, removeClass, deepExtend, elementStyles, eventElement, setDefaultOptions, limitValue, round, bindEvents, unbindEvents, mousewheelDelta, hasClasses } from '../common';\nimport { parseDate } from '../date-utils';\nvar ZOOM_ACCELERATION = 3;\nvar SELECTOR_HEIGHT_ADJUST = 0.1;\n\nfunction createDiv(className) {\n  var element = document.createElement(\"div\");\n\n  if (className) {\n    element.className = className;\n  }\n\n  return element;\n}\n\nfunction closestHandle(element) {\n  var current = element;\n\n  while (current && !hasClasses(current, \"k-handle\")) {\n    current = current.parentNode;\n  }\n\n  return current;\n}\n\nvar Selection = function (Class) {\n  function Selection(chart, categoryAxis, options, observer) {\n    Class.call(this);\n    var chartElement = chart.element;\n    this.options = deepExtend({}, this.options, options);\n    this.chart = chart;\n    this.observer = observer;\n    this.chartElement = chartElement;\n    this.categoryAxis = categoryAxis;\n    this._dateAxis = this.categoryAxis instanceof DateCategoryAxis;\n    this.initOptions();\n    this.visible = this.options.visible && chartElement.offsetHeight;\n\n    if (this.visible) {\n      this.createElements();\n      this.set(this._index(this.options.from), this._index(this.options.to));\n      this.bindEvents();\n    }\n  }\n\n  if (Class) Selection.__proto__ = Class;\n  Selection.prototype = Object.create(Class && Class.prototype);\n  Selection.prototype.constructor = Selection;\n\n  Selection.prototype.onPane = function onPane(pane) {\n    return this.categoryAxis.pane === pane;\n  };\n\n  Selection.prototype.createElements = function createElements() {\n    var options = this.options;\n    var wrapper = this.wrapper = createDiv(\"k-selector\");\n    elementStyles(wrapper, {\n      top: options.offset.top,\n      left: options.offset.left,\n      width: options.width,\n      height: options.height,\n      direction: 'ltr'\n    });\n    var selection = this.selection = createDiv(\"k-selection\");\n    this.leftMask = createDiv(\"k-mask\");\n    this.rightMask = createDiv(\"k-mask\");\n    wrapper.appendChild(this.leftMask);\n    wrapper.appendChild(this.rightMask);\n    wrapper.appendChild(selection);\n    selection.appendChild(createDiv(\"k-selection-bg\"));\n    var leftHandle = this.leftHandle = createDiv(\"k-handle k-left-handle\");\n    var rightHandle = this.rightHandle = createDiv(\"k-handle k-right-handle\");\n    leftHandle.appendChild(createDiv());\n    rightHandle.appendChild(createDiv());\n    selection.appendChild(leftHandle);\n    selection.appendChild(rightHandle);\n    this.chartElement.appendChild(wrapper);\n    var selectionStyles = elementStyles(selection, [\"borderLeftWidth\", \"borderRightWidth\", \"height\"]);\n    var leftHandleHeight = elementStyles(leftHandle, \"height\").height;\n    var rightHandleHeight = elementStyles(rightHandle, \"height\").height;\n    options.selection = {\n      border: {\n        left: selectionStyles.borderLeftWidth,\n        right: selectionStyles.borderRightWidth\n      }\n    };\n    elementStyles(leftHandle, {\n      top: (selectionStyles.height - leftHandleHeight) / 2\n    });\n    elementStyles(rightHandle, {\n      top: (selectionStyles.height - rightHandleHeight) / 2\n    });\n    wrapper.style.cssText = wrapper.style.cssText;\n  };\n\n  Selection.prototype.bindEvents = function bindEvents$1() {\n    var obj;\n\n    if (this.options.mousewheel !== false) {\n      this._mousewheelHandler = this._mousewheel.bind(this);\n      bindEvents(this.wrapper, (obj = {}, obj[MOUSEWHEEL] = this._mousewheelHandler, obj));\n    }\n\n    this._domEvents = DomEventsBuilder.create(this.wrapper, {\n      stopPropagation: true,\n      // applicable for the jQuery UserEvents\n      start: this._start.bind(this),\n      move: this._move.bind(this),\n      end: this._end.bind(this),\n      tap: this._tap.bind(this),\n      press: this._press.bind(this),\n      gesturestart: this._gesturestart.bind(this),\n      gesturechange: this._gesturechange.bind(this),\n      gestureend: this._gestureend.bind(this)\n    });\n  };\n\n  Selection.prototype.initOptions = function initOptions() {\n    var ref = this;\n    var options = ref.options;\n    var categoryAxis = ref.categoryAxis;\n    var box = categoryAxis.pane.chartsBox();\n    var intlService = this.chart.chartService.intl;\n\n    if (this._dateAxis) {\n      deepExtend(options, {\n        min: parseDate(intlService, options.min),\n        max: parseDate(intlService, options.max),\n        from: parseDate(intlService, options.from),\n        to: parseDate(intlService, options.to)\n      });\n    }\n\n    var ref$1 = elementStyles(this.chartElement, [\"paddingLeft\", \"paddingTop\"]);\n    var paddingLeft = ref$1.paddingLeft;\n    var paddingTop = ref$1.paddingTop;\n    this.options = deepExtend({}, {\n      width: box.width(),\n      height: box.height() + SELECTOR_HEIGHT_ADJUST,\n      //workaround for sub-pixel hover on the paths in chrome\n      padding: {\n        left: paddingLeft,\n        top: paddingTop\n      },\n      offset: {\n        left: box.x1 + paddingLeft,\n        top: box.y1 + paddingTop\n      },\n      from: options.min,\n      to: options.max\n    }, options);\n  };\n\n  Selection.prototype.destroy = function destroy() {\n    var obj;\n\n    if (this._domEvents) {\n      this._domEvents.destroy();\n\n      delete this._domEvents;\n    }\n\n    clearTimeout(this._mwTimeout);\n    this._state = null;\n\n    if (this.wrapper) {\n      if (this._mousewheelHandler) {\n        unbindEvents(this.wrapper, (obj = {}, obj[MOUSEWHEEL] = this._mousewheelHandler, obj));\n        this._mousewheelHandler = null;\n      }\n\n      this.chartElement.removeChild(this.wrapper);\n      this.wrapper = null;\n    }\n  };\n\n  Selection.prototype._rangeEventArgs = function _rangeEventArgs(range) {\n    return {\n      axis: this.categoryAxis.options,\n      from: this._value(range.from),\n      to: this._value(range.to)\n    };\n  };\n\n  Selection.prototype._start = function _start(e) {\n    var options = this.options;\n    var target = eventElement(e);\n\n    if (this._state || !target) {\n      return;\n    }\n\n    this.chart._unsetActivePoint();\n\n    this._state = {\n      moveTarget: closestHandle(target) || target,\n      startLocation: e.x ? e.x.location : 0,\n      range: {\n        from: this._index(options.from),\n        to: this._index(options.to)\n      }\n    };\n\n    var args = this._rangeEventArgs({\n      from: this._index(options.from),\n      to: this._index(options.to)\n    });\n\n    if (this.trigger(SELECT_START, args)) {\n      this._state = null;\n    }\n  };\n\n  Selection.prototype._press = function _press(e) {\n    var handle;\n\n    if (this._state) {\n      handle = this._state.moveTarget;\n    } else {\n      handle = closestHandle(eventElement(e));\n    }\n\n    if (handle) {\n      addClass(handle, \"k-handle-active\");\n    }\n  };\n\n  Selection.prototype._move = function _move(e) {\n    if (!this._state) {\n      return;\n    }\n\n    var ref = this;\n    var state = ref._state;\n    var options = ref.options;\n    var categoryAxis = ref.categoryAxis;\n    var range = state.range;\n    var target = state.moveTarget;\n    var reverse = categoryAxis.options.reverse;\n\n    var from = this._index(options.from);\n\n    var to = this._index(options.to);\n\n    var min = this._index(options.min);\n\n    var max = this._index(options.max);\n\n    var delta = state.startLocation - e.x.location;\n    var oldRange = {\n      from: range.from,\n      to: range.to\n    };\n    var span = range.to - range.from;\n    var scale = elementStyles(this.wrapper, \"width\").width / (categoryAxis.categoriesCount() - 1);\n    var offset = Math.round(delta / scale) * (reverse ? -1 : 1);\n\n    if (!target) {\n      return;\n    }\n\n    var leftHandle = hasClasses(target, \"k-left-handle\");\n    var rightHandle = hasClasses(target, \"k-right-handle\");\n\n    if (hasClasses(target, \"k-selection k-selection-bg\")) {\n      range.from = Math.min(Math.max(min, from - offset), max - span);\n      range.to = Math.min(range.from + span, max);\n    } else if (leftHandle && !reverse || rightHandle && reverse) {\n      range.from = Math.min(Math.max(min, from - offset), max - 1);\n      range.to = Math.max(range.from + 1, range.to);\n    } else if (leftHandle && reverse || rightHandle && !reverse) {\n      range.to = Math.min(Math.max(min + 1, to - offset), max);\n      range.from = Math.min(range.to - 1, range.from);\n    }\n\n    if (range.from !== oldRange.from || range.to !== oldRange.to) {\n      this.move(range.from, range.to);\n      this.trigger(SELECT, this._rangeEventArgs(range));\n    }\n  };\n\n  Selection.prototype._end = function _end() {\n    if (this._state) {\n      var moveTarget = this._state.moveTarget;\n\n      if (moveTarget) {\n        removeClass(moveTarget, \"k-handle-active\");\n      }\n\n      var range = this._state.range;\n      this.set(range.from, range.to);\n      this.trigger(SELECT_END, this._rangeEventArgs(range));\n      delete this._state;\n    }\n  };\n\n  Selection.prototype._tap = function _tap(e) {\n    var ref = this;\n    var options = ref.options;\n    var categoryAxis = ref.categoryAxis;\n\n    var coords = this.chart._eventCoordinates(e);\n\n    var categoryIx = categoryAxis.pointCategoryIndex(new Point(coords.x, categoryAxis.box.y1));\n\n    var from = this._index(options.from);\n\n    var to = this._index(options.to);\n\n    var min = this._index(options.min);\n\n    var max = this._index(options.max);\n\n    var span = to - from;\n    var mid = from + span / 2;\n    var range = {};\n    var rightClick = e.event.which === 3;\n    var offset = Math.round(mid - categoryIx);\n\n    if (this._state || rightClick) {\n      return;\n    }\n\n    this.chart._unsetActivePoint();\n\n    if (!categoryAxis.options.justified) {\n      offset--;\n    }\n\n    range.from = Math.min(Math.max(min, from - offset), max - span);\n    range.to = Math.min(range.from + span, max);\n\n    this._start(e);\n\n    if (this._state) {\n      this._state.range = range;\n      this.trigger(SELECT, this._rangeEventArgs(range));\n\n      this._end();\n    }\n  };\n\n  Selection.prototype._mousewheel = function _mousewheel(e) {\n    var this$1 = this;\n    var delta = mousewheelDelta(e);\n\n    this._start({\n      target: this.selection\n    });\n\n    if (this._state) {\n      var range = this._state.range;\n      e.preventDefault();\n      e.stopPropagation();\n\n      if (Math.abs(delta) > 1) {\n        delta *= ZOOM_ACCELERATION;\n      }\n\n      if (this.options.mousewheel.reverse) {\n        delta *= -1;\n      }\n\n      if (this.expand(delta)) {\n        this.trigger(SELECT, {\n          axis: this.categoryAxis.options,\n          delta: delta,\n          originalEvent: e,\n          from: this._value(range.from),\n          to: this._value(range.to)\n        });\n      }\n\n      if (this._mwTimeout) {\n        clearTimeout(this._mwTimeout);\n      }\n\n      this._mwTimeout = setTimeout(function () {\n        this$1._end();\n      }, MOUSEWHEEL_DELAY);\n    }\n  };\n\n  Selection.prototype._gesturestart = function _gesturestart(e) {\n    var options = this.options;\n    this._state = {\n      range: {\n        from: this._index(options.from),\n        to: this._index(options.to)\n      }\n    };\n\n    var args = this._rangeEventArgs(this._state.range);\n\n    if (this.trigger(SELECT_START, args)) {\n      this._state = null;\n    } else {\n      e.preventDefault();\n    }\n  };\n\n  Selection.prototype._gestureend = function _gestureend() {\n    if (this._state) {\n      this.trigger(SELECT_END, this._rangeEventArgs(this._state.range));\n      delete this._state;\n    }\n  };\n\n  Selection.prototype._gesturechange = function _gesturechange(e) {\n    var ref = this;\n    var chart = ref.chart;\n    var state = ref._state;\n    var options = ref.options;\n    var categoryAxis = ref.categoryAxis;\n    var range = state.range;\n\n    var p0 = chart._toModelCoordinates(e.touches[0].x.location).x;\n\n    var p1 = chart._toModelCoordinates(e.touches[1].x.location).x;\n\n    var left = Math.min(p0, p1);\n    var right = Math.max(p0, p1);\n    e.preventDefault();\n    range.from = categoryAxis.pointCategoryIndex(new Point(left)) || options.min;\n    range.to = categoryAxis.pointCategoryIndex(new Point(right)) || options.max;\n    this.move(range.from, range.to);\n    this.trigger(SELECT, this._rangeEventArgs(range));\n  };\n\n  Selection.prototype._index = function _index(value) {\n    var index = value;\n\n    if (value instanceof Date) {\n      index = this.categoryAxis.categoryIndex(value);\n    }\n\n    return index;\n  };\n\n  Selection.prototype._value = function _value(index) {\n    var value = index;\n\n    if (this._dateAxis) {\n      value = this.categoryAxis.categoryAt(index);\n\n      if (value > this.options.max) {\n        value = this.options.max;\n      }\n    }\n\n    return value;\n  };\n\n  Selection.prototype._slot = function _slot(value) {\n    var categoryAxis = this.categoryAxis;\n\n    var index = this._index(value);\n\n    return categoryAxis.getSlot(index, index, true);\n  };\n\n  Selection.prototype.move = function move(from, to) {\n    var options = this.options;\n    var reverse = this.categoryAxis.options.reverse;\n    var offset = options.offset;\n    var padding = options.padding;\n    var border = options.selection.border;\n    var left = reverse ? to : from;\n    var right = reverse ? from : to;\n    var edge = 'x' + (reverse ? 2 : 1);\n\n    var box = this._slot(left);\n\n    var leftMaskWidth = round(box[edge] - offset.left + padding.left);\n    elementStyles(this.leftMask, {\n      width: leftMaskWidth\n    });\n    elementStyles(this.selection, {\n      left: leftMaskWidth\n    });\n    box = this._slot(right);\n    var rightMaskWidth = round(options.width - (box[edge] - offset.left + padding.left));\n    elementStyles(this.rightMask, {\n      width: rightMaskWidth\n    });\n    var distance = options.width - rightMaskWidth;\n\n    if (distance !== options.width) {\n      distance += border.right;\n    }\n\n    elementStyles(this.rightMask, {\n      left: distance\n    });\n    elementStyles(this.selection, {\n      width: Math.max(options.width - (leftMaskWidth + rightMaskWidth) - border.right, 0)\n    });\n  };\n\n  Selection.prototype.set = function set(from, to) {\n    var options = this.options;\n\n    var min = this._index(options.min);\n\n    var max = this._index(options.max);\n\n    var fromValue = limitValue(this._index(from), min, max);\n    var toValue = limitValue(this._index(to), fromValue + 1, max);\n\n    if (options.visible) {\n      this.move(fromValue, toValue);\n    }\n\n    options.from = this._value(fromValue);\n    options.to = this._value(toValue);\n  };\n\n  Selection.prototype.expand = function expand(delta) {\n    var options = this.options;\n\n    var min = this._index(options.min);\n\n    var max = this._index(options.max);\n\n    var zDir = options.mousewheel.zoom;\n\n    var from = this._index(options.from);\n\n    var to = this._index(options.to);\n\n    var range = {\n      from: from,\n      to: to\n    };\n    var oldRange = deepExtend({}, range);\n\n    if (this._state) {\n      range = this._state.range;\n    }\n\n    if (zDir !== RIGHT) {\n      range.from = limitValue(limitValue(from - delta, 0, to - 1), min, max);\n    }\n\n    if (zDir !== LEFT) {\n      range.to = limitValue(limitValue(to + delta, range.from + 1, max), min, max);\n    }\n\n    if (range.from !== oldRange.from || range.to !== oldRange.to) {\n      this.set(range.from, range.to);\n      return true;\n    }\n  };\n\n  Selection.prototype.trigger = function trigger(name, args) {\n    return (this.observer || this.chart).trigger(name, args);\n  };\n\n  return Selection;\n}(Class);\n\nsetDefaultOptions(Selection, {\n  visible: true,\n  mousewheel: {\n    zoom: \"both\"\n  },\n  min: MIN_VALUE,\n  max: MAX_VALUE\n});\nexport default Selection;","map":{"version":3,"sources":["/Users/lazybaccha/Documents/Honeywell/SBE/node_modules/@progress/kendo-charts/dist/es/chart/selection.js"],"names":["DomEventsBuilder","DateCategoryAxis","Point","MOUSEWHEEL_DELAY","MOUSEWHEEL","SELECT_START","SELECT","SELECT_END","LEFT","RIGHT","MIN_VALUE","MAX_VALUE","addClass","Class","removeClass","deepExtend","elementStyles","eventElement","setDefaultOptions","limitValue","round","bindEvents","unbindEvents","mousewheelDelta","hasClasses","parseDate","ZOOM_ACCELERATION","SELECTOR_HEIGHT_ADJUST","createDiv","className","element","document","createElement","closestHandle","current","parentNode","Selection","chart","categoryAxis","options","observer","call","chartElement","_dateAxis","initOptions","visible","offsetHeight","createElements","set","_index","from","to","__proto__","prototype","Object","create","constructor","onPane","pane","wrapper","top","offset","left","width","height","direction","selection","leftMask","rightMask","appendChild","leftHandle","rightHandle","selectionStyles","leftHandleHeight","rightHandleHeight","border","borderLeftWidth","right","borderRightWidth","style","cssText","bindEvents$1","obj","mousewheel","_mousewheelHandler","_mousewheel","bind","_domEvents","stopPropagation","start","_start","move","_move","end","_end","tap","_tap","press","_press","gesturestart","_gesturestart","gesturechange","_gesturechange","gestureend","_gestureend","ref","box","chartsBox","intlService","chartService","intl","min","max","ref$1","paddingLeft","paddingTop","padding","x1","y1","destroy","clearTimeout","_mwTimeout","_state","removeChild","_rangeEventArgs","range","axis","_value","e","target","_unsetActivePoint","moveTarget","startLocation","x","location","args","trigger","handle","state","reverse","delta","oldRange","span","scale","categoriesCount","Math","coords","_eventCoordinates","categoryIx","pointCategoryIndex","mid","rightClick","event","which","justified","this$1","preventDefault","abs","expand","originalEvent","setTimeout","p0","_toModelCoordinates","touches","p1","value","index","Date","categoryIndex","categoryAt","_slot","getSlot","edge","leftMaskWidth","rightMaskWidth","distance","fromValue","toValue","zDir","zoom","name"],"mappings":"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","sourcesContent":["import { DomEventsBuilder } from '../services';\n\nimport { DateCategoryAxis, Point } from '../core';\n\nimport { MOUSEWHEEL_DELAY, MOUSEWHEEL, SELECT_START, SELECT, SELECT_END } from './constants';\n\nimport { LEFT, RIGHT, MIN_VALUE, MAX_VALUE } from '../common/constants';\nimport { addClass, Class, removeClass, deepExtend, elementStyles, eventElement, setDefaultOptions, limitValue, round, bindEvents, unbindEvents, mousewheelDelta, hasClasses } from '../common';\nimport { parseDate } from '../date-utils';\n\nvar ZOOM_ACCELERATION = 3;\nvar SELECTOR_HEIGHT_ADJUST = 0.1;\n\nfunction createDiv(className) {\n    var element = document.createElement(\"div\");\n    if (className) {\n        element.className = className;\n    }\n\n    return element;\n}\n\nfunction closestHandle(element) {\n    var current = element;\n    while (current && !hasClasses(current, \"k-handle\")) {\n        current = current.parentNode;\n    }\n\n    return current;\n}\n\nvar Selection = (function (Class) {\n    function Selection(chart, categoryAxis, options, observer) {\n        Class.call(this);\n\n        var chartElement = chart.element;\n\n        this.options = deepExtend({}, this.options, options);\n        this.chart = chart;\n        this.observer = observer;\n        this.chartElement = chartElement;\n        this.categoryAxis = categoryAxis;\n        this._dateAxis = this.categoryAxis instanceof DateCategoryAxis;\n\n        this.initOptions();\n\n        this.visible = this.options.visible && chartElement.offsetHeight;\n\n        if (this.visible) {\n            this.createElements();\n\n            this.set(this._index(this.options.from), this._index(this.options.to));\n\n            this.bindEvents();\n        }\n    }\n\n    if ( Class ) Selection.__proto__ = Class;\n    Selection.prototype = Object.create( Class && Class.prototype );\n    Selection.prototype.constructor = Selection;\n\n    Selection.prototype.onPane = function onPane (pane) {\n        return this.categoryAxis.pane === pane;\n    };\n\n    Selection.prototype.createElements = function createElements () {\n        var options = this.options;\n        var wrapper = this.wrapper = createDiv(\"k-selector\");\n        elementStyles(wrapper, {\n            top: options.offset.top,\n            left: options.offset.left,\n            width: options.width,\n            height: options.height,\n            direction: 'ltr'\n        });\n        var selection = this.selection = createDiv(\"k-selection\");\n        this.leftMask = createDiv(\"k-mask\");\n        this.rightMask = createDiv(\"k-mask\");\n\n        wrapper.appendChild(this.leftMask);\n        wrapper.appendChild(this.rightMask);\n        wrapper.appendChild(selection);\n\n        selection.appendChild(createDiv(\"k-selection-bg\"));\n\n        var leftHandle = this.leftHandle = createDiv(\"k-handle k-left-handle\");\n        var rightHandle = this.rightHandle = createDiv(\"k-handle k-right-handle\");\n        leftHandle.appendChild(createDiv());\n        rightHandle.appendChild(createDiv());\n\n        selection.appendChild(leftHandle);\n        selection.appendChild(rightHandle);\n\n        this.chartElement.appendChild(wrapper);\n        var selectionStyles = elementStyles(selection, [ \"borderLeftWidth\", \"borderRightWidth\", \"height\" ]);\n        var leftHandleHeight = elementStyles(leftHandle, \"height\").height;\n        var rightHandleHeight = elementStyles(rightHandle, \"height\").height;\n\n        options.selection = {\n            border: {\n                left: selectionStyles.borderLeftWidth,\n                right: selectionStyles.borderRightWidth\n            }\n        };\n\n        elementStyles(leftHandle, {\n            top: (selectionStyles.height - leftHandleHeight) / 2\n        });\n\n        elementStyles(rightHandle, {\n            top: (selectionStyles.height - rightHandleHeight) / 2\n        });\n\n        wrapper.style.cssText = wrapper.style.cssText;\n    };\n\n    Selection.prototype.bindEvents = function bindEvents$1 () {\n        var obj;\n\n        if (this.options.mousewheel !== false) {\n            this._mousewheelHandler = this._mousewheel.bind(this);\n            bindEvents(this.wrapper, ( obj = {}, obj[ MOUSEWHEEL ] = this._mousewheelHandler, obj ));\n        }\n\n        this._domEvents = DomEventsBuilder.create(this.wrapper, {\n            stopPropagation: true, // applicable for the jQuery UserEvents\n            start: this._start.bind(this),\n            move: this._move.bind(this),\n            end: this._end.bind(this),\n            tap: this._tap.bind(this),\n            press: this._press.bind(this),\n            gesturestart: this._gesturestart.bind(this),\n            gesturechange: this._gesturechange.bind(this),\n            gestureend: this._gestureend.bind(this)\n        });\n    };\n\n    Selection.prototype.initOptions = function initOptions () {\n        var ref = this;\n        var options = ref.options;\n        var categoryAxis = ref.categoryAxis;\n        var box = categoryAxis.pane.chartsBox();\n        var intlService = this.chart.chartService.intl;\n\n        if (this._dateAxis) {\n            deepExtend(options, {\n                min: parseDate(intlService, options.min),\n                max: parseDate(intlService, options.max),\n                from: parseDate(intlService, options.from),\n                to: parseDate(intlService, options.to)\n            });\n        }\n\n        var ref$1 = elementStyles(this.chartElement, [ \"paddingLeft\", \"paddingTop\" ]);\n        var paddingLeft = ref$1.paddingLeft;\n        var paddingTop = ref$1.paddingTop;\n\n        this.options = deepExtend({}, {\n            width: box.width(),\n            height: box.height() + SELECTOR_HEIGHT_ADJUST, //workaround for sub-pixel hover on the paths in chrome\n            padding: {\n                left: paddingLeft,\n                top: paddingTop\n            },\n            offset: {\n                left: box.x1 + paddingLeft,\n                top: box.y1 + paddingTop\n            },\n            from: options.min,\n            to: options.max\n        }, options);\n    };\n\n    Selection.prototype.destroy = function destroy () {\n        var obj;\n\n        if (this._domEvents) {\n            this._domEvents.destroy();\n            delete this._domEvents;\n        }\n\n        clearTimeout(this._mwTimeout);\n        this._state = null;\n\n        if (this.wrapper) {\n            if (this._mousewheelHandler) {\n                unbindEvents(this.wrapper, ( obj = {}, obj[ MOUSEWHEEL ] = this._mousewheelHandler, obj ));\n                this._mousewheelHandler = null;\n            }\n            this.chartElement.removeChild(this.wrapper);\n            this.wrapper = null;\n        }\n    };\n\n    Selection.prototype._rangeEventArgs = function _rangeEventArgs (range) {\n\n        return {\n            axis: this.categoryAxis.options,\n            from: this._value(range.from),\n            to: this._value(range.to)\n        };\n    };\n\n    Selection.prototype._start = function _start (e) {\n        var options = this.options;\n        var target = eventElement(e);\n\n        if (this._state || !target) {\n            return;\n        }\n\n        this.chart._unsetActivePoint();\n        this._state = {\n            moveTarget: closestHandle(target) || target,\n            startLocation: e.x ? e.x.location : 0,\n            range: {\n                from: this._index(options.from),\n                to: this._index(options.to)\n            }\n        };\n\n        var args = this._rangeEventArgs({\n            from: this._index(options.from),\n            to: this._index(options.to)\n        });\n\n        if (this.trigger(SELECT_START, args)) {\n            this._state = null;\n        }\n    };\n\n    Selection.prototype._press = function _press (e) {\n        var handle;\n        if (this._state) {\n            handle = this._state.moveTarget;\n        } else {\n            handle = closestHandle(eventElement(e));\n        }\n        if (handle) {\n            addClass(handle, \"k-handle-active\");\n        }\n    };\n\n    Selection.prototype._move = function _move (e) {\n        if (!this._state) {\n            return;\n        }\n\n        var ref = this;\n        var state = ref._state;\n        var options = ref.options;\n        var categoryAxis = ref.categoryAxis;\n        var range = state.range;\n        var target = state.moveTarget;\n        var reverse = categoryAxis.options.reverse;\n        var from = this._index(options.from);\n        var to = this._index(options.to);\n        var min = this._index(options.min);\n        var max = this._index(options.max);\n        var delta = state.startLocation - e.x.location;\n        var oldRange = { from: range.from, to: range.to };\n        var span = range.to - range.from;\n        var scale = elementStyles(this.wrapper, \"width\").width / (categoryAxis.categoriesCount() - 1);\n        var offset = Math.round(delta / scale) * (reverse ? -1 : 1);\n\n        if (!target) {\n            return;\n        }\n\n        var leftHandle = hasClasses(target, \"k-left-handle\");\n        var rightHandle = hasClasses(target, \"k-right-handle\");\n\n        if (hasClasses(target, \"k-selection k-selection-bg\")) {\n            range.from = Math.min(\n                Math.max(min, from - offset),\n                max - span\n            );\n            range.to = Math.min(\n                range.from + span,\n                max\n            );\n        } else if ((leftHandle && !reverse) || (rightHandle && reverse)) {\n            range.from = Math.min(\n                Math.max(min, from - offset),\n                max - 1\n            );\n            range.to = Math.max(range.from + 1, range.to);\n        } else if ((leftHandle && reverse) || (rightHandle && !reverse)) {\n            range.to = Math.min(\n                Math.max(min + 1, to - offset),\n                max\n            );\n            range.from = Math.min(range.to - 1, range.from);\n        }\n\n        if (range.from !== oldRange.from || range.to !== oldRange.to) {\n            this.move(range.from, range.to);\n            this.trigger(SELECT, this._rangeEventArgs(range));\n        }\n    };\n\n    Selection.prototype._end = function _end () {\n        if (this._state) {\n            var moveTarget = this._state.moveTarget;\n            if (moveTarget) {\n                removeClass(moveTarget, \"k-handle-active\");\n            }\n\n            var range = this._state.range;\n            this.set(range.from, range.to);\n            this.trigger(SELECT_END, this._rangeEventArgs(range));\n\n            delete this._state;\n        }\n    };\n\n    Selection.prototype._tap = function _tap (e) {\n        var ref = this;\n        var options = ref.options;\n        var categoryAxis = ref.categoryAxis;\n        var coords = this.chart._eventCoordinates(e);\n        var categoryIx = categoryAxis.pointCategoryIndex(new Point(coords.x, categoryAxis.box.y1));\n        var from = this._index(options.from);\n        var to = this._index(options.to);\n        var min = this._index(options.min);\n        var max = this._index(options.max);\n        var span = to - from;\n        var mid = from + span / 2;\n        var range = {};\n        var rightClick = e.event.which === 3;\n        var offset = Math.round(mid - categoryIx);\n\n        if (this._state || rightClick) {\n            return;\n        }\n\n\n        this.chart._unsetActivePoint();\n\n        if (!categoryAxis.options.justified) {\n            offset--;\n        }\n\n        range.from = Math.min(\n            Math.max(min, from - offset),\n            max - span\n        );\n\n        range.to = Math.min(range.from + span, max);\n\n        this._start(e);\n        if (this._state) {\n            this._state.range = range;\n            this.trigger(SELECT, this._rangeEventArgs(range));\n            this._end();\n        }\n    };\n\n    Selection.prototype._mousewheel = function _mousewheel (e) {\n        var this$1 = this;\n\n        var delta = mousewheelDelta(e);\n\n        this._start({ target: this.selection });\n\n        if (this._state) {\n            var range = this._state.range;\n\n            e.preventDefault();\n            e.stopPropagation();\n\n            if (Math.abs(delta) > 1) {\n                delta *= ZOOM_ACCELERATION;\n            }\n\n            if (this.options.mousewheel.reverse) {\n                delta *= -1;\n            }\n\n            if (this.expand(delta)) {\n                this.trigger(SELECT, {\n                    axis: this.categoryAxis.options,\n                    delta: delta,\n                    originalEvent: e,\n                    from: this._value(range.from),\n                    to: this._value(range.to)\n                });\n            }\n\n            if (this._mwTimeout) {\n                clearTimeout(this._mwTimeout);\n            }\n\n            this._mwTimeout = setTimeout(function () {\n                this$1._end();\n            }, MOUSEWHEEL_DELAY);\n        }\n    };\n\n    Selection.prototype._gesturestart = function _gesturestart (e) {\n        var options = this.options;\n\n        this._state = {\n            range: {\n                from: this._index(options.from),\n                to: this._index(options.to)\n            }\n        };\n        var args = this._rangeEventArgs(this._state.range);\n\n        if (this.trigger(SELECT_START, args)) {\n            this._state = null;\n        } else {\n            e.preventDefault();\n        }\n    };\n\n    Selection.prototype._gestureend = function _gestureend () {\n        if (this._state) {\n            this.trigger(SELECT_END, this._rangeEventArgs(this._state.range));\n            delete this._state;\n        }\n    };\n\n    Selection.prototype._gesturechange = function _gesturechange (e) {\n        var ref = this;\n        var chart = ref.chart;\n        var state = ref._state;\n        var options = ref.options;\n        var categoryAxis = ref.categoryAxis;\n        var range = state.range;\n        var p0 = chart._toModelCoordinates(e.touches[0].x.location).x;\n        var p1 = chart._toModelCoordinates(e.touches[1].x.location).x;\n        var left = Math.min(p0, p1);\n        var right = Math.max(p0, p1);\n\n        e.preventDefault();\n\n        range.from = categoryAxis.pointCategoryIndex(new Point(left)) || options.min;\n\n        range.to = categoryAxis.pointCategoryIndex(new Point(right)) || options.max;\n\n        this.move(range.from, range.to);\n\n        this.trigger(SELECT, this._rangeEventArgs(range));\n    };\n\n    Selection.prototype._index = function _index (value) {\n        var index = value;\n\n        if (value instanceof Date) {\n            index = this.categoryAxis.categoryIndex(value);\n        }\n\n        return index;\n    };\n\n    Selection.prototype._value = function _value (index) {\n        var value = index;\n        if (this._dateAxis) {\n            value = this.categoryAxis.categoryAt(index);\n            if (value > this.options.max) {\n                value = this.options.max;\n            }\n        }\n\n        return value;\n    };\n\n    Selection.prototype._slot = function _slot (value) {\n        var categoryAxis = this.categoryAxis;\n        var index = this._index(value);\n\n        return categoryAxis.getSlot(index, index, true);\n    };\n\n    Selection.prototype.move = function move (from, to) {\n        var options = this.options;\n        var reverse = this.categoryAxis.options.reverse;\n        var offset = options.offset;\n        var padding = options.padding;\n        var border = options.selection.border;\n        var left = reverse ? to : from;\n        var right = reverse ? from : to;\n        var edge = 'x' + (reverse ? 2 : 1);\n\n        var box = this._slot(left);\n        var leftMaskWidth = round(box[edge] - offset.left + padding.left);\n\n        elementStyles(this.leftMask, {\n            width: leftMaskWidth\n        });\n        elementStyles(this.selection, {\n            left: leftMaskWidth\n        });\n\n        box = this._slot(right);\n\n        var rightMaskWidth = round(options.width - (box[edge] - offset.left + padding.left));\n        elementStyles(this.rightMask, {\n            width: rightMaskWidth\n        });\n\n        var distance = options.width - rightMaskWidth;\n        if (distance !== options.width) {\n            distance += border.right;\n        }\n\n        elementStyles(this.rightMask, {\n            left: distance\n        });\n        elementStyles(this.selection, {\n            width: Math.max(options.width - (leftMaskWidth + rightMaskWidth) - border.right, 0)\n        });\n    };\n\n    Selection.prototype.set = function set (from, to) {\n        var options = this.options;\n        var min = this._index(options.min);\n        var max = this._index(options.max);\n        var fromValue = limitValue(this._index(from), min, max);\n        var toValue = limitValue(this._index(to), fromValue + 1, max);\n\n        if (options.visible) {\n            this.move(fromValue, toValue);\n        }\n\n        options.from = this._value(fromValue);\n        options.to = this._value(toValue);\n    };\n\n    Selection.prototype.expand = function expand (delta) {\n        var options = this.options;\n        var min = this._index(options.min);\n        var max = this._index(options.max);\n        var zDir = options.mousewheel.zoom;\n        var from = this._index(options.from);\n        var to = this._index(options.to);\n        var range = { from: from, to: to };\n        var oldRange = deepExtend({}, range);\n\n        if (this._state) {\n            range = this._state.range;\n        }\n\n        if (zDir !== RIGHT) {\n            range.from = limitValue(\n                limitValue(from - delta, 0, to - 1),\n                min, max\n            );\n        }\n\n        if (zDir !== LEFT) {\n            range.to = limitValue(\n                limitValue(to + delta, range.from + 1, max),\n                min,\n                max\n             );\n        }\n\n        if (range.from !== oldRange.from || range.to !== oldRange.to) {\n            this.set(range.from, range.to);\n            return true;\n        }\n    };\n\n    Selection.prototype.trigger = function trigger (name, args) {\n        return (this.observer || this.chart).trigger(name, args);\n    };\n\n    return Selection;\n}(Class));\n\nsetDefaultOptions(Selection, {\n    visible: true,\n    mousewheel: {\n        zoom: \"both\"\n    },\n    min: MIN_VALUE,\n    max: MAX_VALUE\n});\n\nexport default Selection;\n"]},"metadata":{},"sourceType":"module"}